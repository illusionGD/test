"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var EnemyFactory=function(){function e(){_classCallCheck(this,e),this.config={moveSpeed:100,createDis:500,scale:.5,maxCount:5},this.lasTime=(new Date).getTime(),this.init()}return _createClass(e,[{key:"init",value:function(){this.isDead=!1,this.enemyGroup=game.add.group(),this.enemyGroup.enableBody=!0}},{key:"move",value:function(e,t){var o=this,a=0<arguments.length&&void 0!==e?e:0,s=1<arguments.length&&void 0!==t?t:0;this.enemyGroup.forEachAlive(function(e){var t=computeVector(a,s,e.x,e.y),n=t.x,i=t.y;e.isDead?(e.body.velocity.x=n/2*-o.config.moveSpeed,e.body.velocity.y=0):(e.body.velocity.x=n*o.config.moveSpeed,e.body.velocity.y=i*o.config.moveSpeed,e.frame=0<n?2:1)})}},{key:"createEnemy",value:function(e,t){var n;(new Date).getTime()-this.lasTime>this.config.createDis&&this.config.maxCount>this.enemyGroup.total&&((n=this.enemyGroup.getFirstExists(!1))||((n=this.enemyGroup.create(e,t,keyMap.enemy)).scale.set(.6,.6),n.anchor.set(.5,1),n.body.setSize(n.width,n.height),n.shakeTween=game.add.tween(n).to({rotation:.2},1e3,Phaser.Easing.Cubic.In,!0,0,-1,!0),n.DeadTween=game.add.tween(n).to({},500,Phaser.Easing.Cubic.In,!1),n.DeadTween.onComplete.add(function(){n.kill()}),n.DeadTween.onStart.add(function(){n.shakeTween.stop(),n.frame=1===n.frame?0:3,n.isDead=!0})),this.resetEnemy(n,e,t),this.lasTime=(new Date).getTime())}},{key:"resetEnemy",value:function(e,t,n){e.isDead=!1,e.shakeTween.start(),e.frame=1,e.reset(t,n),e.body.collideWorldBounds=!0}},{key:"stop",value:function(){this.enemyGroup.forEachAlive(function(e){e.body.velocity.x=0,e.body.velocity.y=0,e.shakeTween.pause()})}}]),e}();